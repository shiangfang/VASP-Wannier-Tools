% This code prepares the numerical parameters for generating Hamiltonians
% for TMDCs
%
% Reference citation: Phys. Rev. B 92, 205108 (2015).
% Ab initio tight-binding Hamiltonian for transition metal dichalcogenides
% by Shiang Fang, Rodrick Kuate Defo, Sharmila N. Shirodkar, Simon Lieu, Georgios A. Tritsaris, and Efthimios Kaxiras
% code version: July 2017

% Spin orbit couplign strength
soc_mo=0.0836;
soc_w=0.2874;
soc_s=0.0556;
soc_se=0.2470;

% TMDC TBH parms (40 for each type)
mos2_tbh=[1.0688,-0.77546,-1.2902,-0.138,0.08738,-2.8949,-1.9065,-0.2069,0.032345,-0.17385,0.86513,-0.18725,-0.29791,0.2747,-0.55809,-0.19158,0.91215,0.0058631,-0.067891,0.40961,0.007516,-0.25616,-0.099527,-0.070508,-0.1145,-0.24872,0.10626,-0.038544,-0.7883,-1.379,2.1584,-0.88356,-0.94019,1.4114,-0.95348,0.65168,-0.068597,-0.14979,-0.22048,-0.24507];
mose2_tbh=[0.78192,-0.65672,-1.1726,-0.22974,0.014947,-2.9015,-1.7806,-0.14602,0.017738,-0.21122,0.9638,-0.17242,-0.26363,0.25053,-0.47341,-0.2166,0.99107,-0.0036331,-0.07347,0.35202,0.0047333,-0.19118,-0.075456,-0.068039,-0.096031,-0.20118,0.12163,-0.039403,-0.69463,-1.3258,1.9415,-0.77195,-0.87375,1.2677,-0.85776,0.55453,-0.069127,-0.15531,-0.2227,-0.21537];
ws2_tbh=[1.3754,-1.1278,-1.5534,-0.039259,0.19844,-3.3706,-2.3461,-0.20109,0.026255,-0.17491,0.87261,-0.21869,-0.37161,0.35371,-0.68916,-0.2112,0.96733,0.014269,-0.081777,0.48965,-0.031484,-0.31058,-0.11054,-0.098891,-0.14665,-0.30304,0.16454,-0.10178,-0.88549,-1.4376,2.3121,-1.013,-0.98778,1.5629,-0.94906,0.67181,-0.065943,-0.15333,-0.26184,-0.27364];
wse2_tbh=[1.0349,-0.95728,-1.3937,-0.16674,0.098437,-3.3642,-2.182,-0.13951,0.012861,-0.21706,0.97629,-0.19847,-0.33299,0.31903,-0.58366,-0.23985,1.047,0.0029342,-0.091183,0.42334,-0.037681,-0.2321,-0.079716,-0.09203,-0.12498,-0.24558,0.18574,-0.10266,-0.77438,-1.4014,2.0858,-0.8998,-0.90437,1.403,-0.8548,0.57113,-0.067618,-0.16076,-0.26179,-0.24244];

all_tbh=[mos2_tbh;mose2_tbh;ws2_tbh;wse2_tbh];
mono_tbh_parm=all_tbh(tmdc,:);

% crystal structure and TBH parameters
switch tmdc
    case 1
        % MoS2 monolayer
        a1=[3.1824 ,0.0 ,0.0];
        a2=[-1.5912 ,2.7560, 0.0];
        a3=[0,0,20];
        
        soc_m=soc_mo;
        soc_x=soc_s;
        
    case 2
        % MoSe2 monolayer
        a1=[3.3174 0.0 0.0];
        a2=[-1.6587 2.8730 0.0];
        a3=[0,0,20];
        
        soc_m=soc_mo;
        soc_x=soc_se;
        
    case 3
        % WS2 monolayer
        a1=[3.1817 0.0 0.0];
        a2=[-1.5909 2.7554 0.0];
        a3=[0,0,20];
        
        soc_m=soc_w;
        soc_x=soc_s;
        
    case 4
        % WSe2 monolayer
        a1=[3.3155 0.0 0.0];
        a2=[-1.6578 2.8713 0.0];
        a3=[0,0,20];
        
        soc_m=soc_w;
        soc_x=soc_se;
        
    otherwise
        'Oops, something is wrong for tmdc value'
end

%reciprocal lattice vector
v=abs(dot(a1,cross(a2,a3)));
b1=2*pi*cross(a2,a3)/v;
b2=2*pi*cross(a3,a1)/v;
b3=2*pi*cross(a1,a2)/v;



